# This test runs a linear ITG instability calculation using a circular Miller geometry with Cyclone-base-case-like parameters.
# This test uses a Boltzmann adiabatic electron response.

 debug = false

[Dimensions]
 ntheta = 32            # number of points along field line (theta) per 2pi segment    
 nperiod = 2            # number of 2pi segments along field line is 2*nperiod-1
 nky = 16               # number of (de-aliased) fourier modes in y
 nkx = 1                # number of (de-aliased) fourier modes in x

 nhermite = 48          # number of hermite moments (v_parallel resolution)
 nlaguerre = 16         # number of laguerre moments (mu B resolution)
 nspecies = 1           # number of evolved kinetic species (adiabatic electrons don't count towards nspecies)

[Domain]
 y0 = 20.0              # controls box length in y (in units of rho_ref) and minimum ky, so that ky_min*rho_ref = 1/y0 
 boundary = "linked"    # use twist-shift boundary conditions along field line

[Physics]
 beta = 0.0                      # reference normalized pressure, beta = n_ref T_ref / ( B_ref^2 / (8 pi))
 nonlinear_mode = false          # this is a linear calculation

[Time]
 dt = 0.005             # timestep size (in units of L_ref/vt_ref)
 nstep = 30000          # number of timesteps
 scheme = "sspx3"       # use SSPx3 timestepping scheme

[Initialization]
 ikpar_init = 0                  # parallel wavenumber of initial perturbation
 init_field = "density"          # initial condition set in density
 init_amp = 1.0                  # amplitude of initial condition

[Geometry]
 igeo = 1                        # use Miller geometry, and read geometry coefficients from "eik"-style text file
 geofile = "itg_miller.eik.out"  # name of geometry file
# WARNING: the following Miller parameters are not read directly by GX, but can instead be used to create the above geometry file
# using the miller geometry module via
# python ../../../geometry_modules/miller/gx_geo.py itg_miller_adiabatic_electrons.in itg_miller.eik.out
# changing the parameters below without regenerating a new geometry file will have no effect on GX
 rhoc = 0.5                      # flux surface label, r/a
 Rmaj = 2.77778                  # major radius of center of flux surface, normalized to L_ref
 R_geo = 2.77778                 # major radius of magnetic field reference point, normalized to L_ref (i.e. B_t(R_geo) = B_ref)
 qinp = 1.4                      # safety factor
 shat = 0.8                      # magnetic shear
 shift = 0.0                     # shafranov shift
 akappa = 1.0                    # elongation of flux surface
 akappri = 0.0                   # radial gradient of elongation
 tri = 0.0                       # triangularity of flux surface 
 tripri = 0.0                    # radial gradient of triangularity
 betaprim = 0.0                  # radial gradient of beta

# it is okay to have extra species data here; only the first nspecies elements of each item are used
[species]
 z     = [ 1.0,      -1.0     ]         # charge (normalized to Z_ref)
 mass  = [ 1.0,       2.7e-4  ]         # mass (normalized to m_ref)
 dens  = [ 1.0,       1.0     ]         # density (normalized to dens_ref)
 temp  = [ 1.0,       1.0     ]         # temperature (normalized to T_ref)
 tprim = [ 2.49,       0.0     ]        # temperature gradient, L_ref/L_T
 fprim = [ 0.8,       0.0     ]         # density gradient, L_ref/L_n
 vnewk = [ 0.0,       0.0     ]         # collision frequency
 type  = [ "ion",  "electron" ]         # species type

[Boltzmann]
 add_Boltzmann_species = true    # use a Boltzmann species
 Boltzmann_type = "electrons"    # the Boltzmann species will be electrons
 tau_fac = 1.0                   # temperature ratio, T_i/T_e

[Dissipation]
 closure_model = "none"          # no closure assumptions (just truncation)
 hypercollisions = true          # use hypercollision model
 nu_hyper_m = 0.5                # coefficient of hermite hypercollisions
 p_hyper_m = 6                   # exponent of hermite hypercollisions
 nu_hyper_l = 0.5                # coefficient of laguerre hypercollisions
 p_hyper_l = 6                   # exponent of laguerre hypercollisions

[Diagnostics]
 nwrite = 1000                   # write diagnostics every 1000 timesteps
 omega  = true                   # compute and write growth rates and frequencies
 fixed_amplitude = true          # avoid silly large numbers, but use only without linked cells
 
[Wspectra]                       # spectra of W = |G_lm|**2
species          = false
hermite          = false
laguerre         = false
hermite_laguerre = true          # W(l,m) (summed over kx, ky, z)
kx               = false
ky               = true          # W(ky) (summed over kx, z, l, m)
kxky             = false
z                = false

[Pspectra]                      # spectra of P = ( 1 - Gamma_0(b_s) ) |Phi|**2
species          = false
kx               = false
ky               = true         # P(ky) (summed over kx, z)
kxky             = false
z                = true         # P(z) (summed over kx, ky)

